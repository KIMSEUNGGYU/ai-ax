# ai-ax v0.4 Architecture

## 레포 전체 구조

```mermaid
graph TB
    subgraph REPO["ai-ax (Marketplace)"]
        MKT[".claude-plugin/marketplace.json"]

        subgraph FEW["fe-workflow v0.4 (등록됨)"]
            direction TB
            FEW_META[".claude-plugin/plugin.json"]
            FEW_SK["skills/fe-principles"]
            FEW_CMD["commands/ x4"]
            FEW_AGT["agents/ x2"]
            FEW_CONV["conventions/ x4"]
        end

        subgraph SM["session-manager v0.1 (등록됨)"]
            direction TB
            SM_META[".claude-plugin/plugin.json"]
            SM_CMD["commands/ x3"]
            SM_HK["hooks/hooks.json"]
            SM_SC["scripts/session-start.mjs"]
        end

        subgraph MR["mini-review (미등록, 학습용)"]
            direction TB
            MR_META[".claude-plugin/plugin.json"]
            MR_SK["skills/review-criteria"]
            MR_CMD["commands/review"]
            MR_AGT["agents/code-reviewer"]
            MR_HK["hooks/hooks.json"]
        end

        subgraph EXT["session-wrap (외부 플러그인)"]
            direction TB
            EXT_CMD["/wrap"]
            EXT_AGT["agents/ x5"]
            EXT_SK["skills/ x3"]
        end

        subgraph DOCS["설계/학습 문서"]
            direction TB
            GYU[".gyu/ (사용자 소유)"]
            AI[".ai/ (Claude 소유)"]
        end
    end

    MKT -->|"등록"| FEW
    MKT -->|"등록"| SM
    MKT -.->|"미등록"| MR
    SM -.->|"보완"| EXT

    style MKT fill:#3b82f6,color:#fff
    style FEW_META fill:#64748b,color:#fff
    style FEW_SK fill:#8b5cf6,color:#fff
    style FEW_CMD fill:#06b6d4,color:#fff
    style FEW_AGT fill:#ec4899,color:#fff
    style FEW_CONV fill:#f59e0b,color:#fff
    style SM_META fill:#64748b,color:#fff
    style SM_CMD fill:#06b6d4,color:#fff
    style SM_HK fill:#22c55e,color:#fff
    style SM_SC fill:#22c55e,color:#fff
    style MR_META fill:#64748b,color:#fff
    style MR_SK fill:#8b5cf6,color:#fff
    style MR_CMD fill:#06b6d4,color:#fff
    style MR_AGT fill:#ec4899,color:#fff
    style MR_HK fill:#22c55e,color:#fff
    style EXT_CMD fill:#06b6d4,color:#fff
    style EXT_AGT fill:#ec4899,color:#fff
    style EXT_SK fill:#8b5cf6,color:#fff
    style GYU fill:#a3a3a3,color:#fff
    style AI fill:#a3a3a3,color:#fff
```

## 플러그인 상세 — fe-workflow v0.4

```mermaid
graph TB
    subgraph CC["Claude Code"]
        USER["사용자"]
    end

    subgraph PLUGIN["fe-workflow v0.4"]
        subgraph SKILLS["Skill (자동 적용)"]
            S1["fe-principles<br/>코드 원칙 요약 자동 주입"]
        end

        subgraph COMMANDS["Commands (사용자 호출)"]
            C1["/architecture"]
            C2["/review"]
            C3["/pr"]
            C4["/_pr (회사용)"]
        end

        subgraph AGENTS["Agents (위임 실행)"]
            A1["architect<br/>opus 모델, 3-Step 설계"]
            A2["code-reviewer<br/>리뷰 + 점수"]
        end

        subgraph CONV["conventions/ (SSOT)"]
            CV1["code-principles.md"]
            CV2["folder-structure.md"]
            CV3["api-layer.md"]
            CV4["error-handling.md"]
        end
    end

    USER -->|"코드 작성"| S1
    USER -->|"/command"| COMMANDS
    C1 -->|"위임"| A1
    C2 -->|"위임"| A2
    S1 -.->|"참조"| CONV
    A1 -.->|"참조"| CONV
    A2 -.->|"참조"| CONV

    style S1 fill:#8b5cf6,color:#fff
    style C1 fill:#06b6d4,color:#fff
    style C2 fill:#06b6d4,color:#fff
    style C3 fill:#06b6d4,color:#fff
    style C4 fill:#06b6d4,color:#fff
    style A1 fill:#ec4899,color:#fff
    style A2 fill:#ec4899,color:#fff
    style CV1 fill:#f59e0b,color:#fff
    style CV2 fill:#f59e0b,color:#fff
    style CV3 fill:#f59e0b,color:#fff
    style CV4 fill:#f59e0b,color:#fff
    style USER fill:#7c3aed,color:#fff
```

## 플러그인 상세 — session-manager v0.1

```mermaid
graph TB
    subgraph CC["Claude Code"]
        USER["사용자"]
    end

    subgraph PLUGIN["session-manager v0.1"]
        subgraph COMMANDS["Commands"]
            C1["/save"]
            C2["/dashboard"]
            C3["/note"]
        end

        subgraph HOOKS["Hook"]
            H1["SessionStart<br/>STATUS.md 자동 로드"]
        end

        subgraph SCRIPTS["Scripts"]
            SC1["session-start.mjs"]
        end
    end

    subgraph STORAGE[".ai/ (저장소)"]
        ST1["STATUS.md"]
        ST2["DECISIONS.md"]
        ST3["logs/sessions/*.md"]
        ST4["logs/habit-score.md"]
        ST5["notes/*.md"]
    end

    H1 -->|"실행"| SC1
    SC1 -.->|"읽기"| ST1
    USER -->|"/save"| C1
    USER -->|"/dashboard"| C2
    USER -->|"/note"| C3
    C1 -->|"덮어쓰기"| ST1
    C1 -->|"누적"| ST2
    C1 -->|"생성"| ST3
    C1 -->|"행 추가"| ST4
    C2 -.->|"읽기"| ST3
    C2 -.->|"읽기"| ST4
    C3 -->|"생성/병합"| ST5

    style C1 fill:#06b6d4,color:#fff
    style C2 fill:#06b6d4,color:#fff
    style C3 fill:#06b6d4,color:#fff
    style H1 fill:#22c55e,color:#fff
    style SC1 fill:#22c55e,color:#fff
    style ST1 fill:#a3a3a3,color:#fff
    style ST2 fill:#a3a3a3,color:#fff
    style ST3 fill:#a3a3a3,color:#fff
    style ST4 fill:#a3a3a3,color:#fff
    style ST5 fill:#a3a3a3,color:#fff
    style USER fill:#7c3aed,color:#fff
```

## 통합 워크플로우

```mermaid
flowchart LR
    A["세션 시작<br/>(자동: Hook)"] --> B["/architecture<br/>설계"]
    B --> C["구현<br/>(fe-principles 자동)"]
    C --> D["/review<br/>코드 리뷰"]
    D --> E["/pr 또는 /_pr<br/>PR 생성"]
    E --> F["/note<br/>학습 정리"]
    F --> G["/wrap<br/>세션 분석"]
    G --> H["/save<br/>상태 저장 + 점수"]

    style A fill:#22c55e,color:#fff
    style B fill:#06b6d4,color:#fff
    style C fill:#8b5cf6,color:#fff
    style D fill:#06b6d4,color:#fff
    style E fill:#06b6d4,color:#fff
    style F fill:#06b6d4,color:#fff
    style G fill:#f59e0b,color:#fff
    style H fill:#06b6d4,color:#fff
```

## v0.3 → v0.4 변경점

```mermaid
graph LR
    subgraph V3["v0.3"]
        direction TB
        V3_FEW["fe-workflow<br/>Command x6, Agent x2"]
    end

    subgraph V4["v0.4"]
        direction TB
        V4_FEW["fe-workflow<br/>Command x4, Agent x2"]
        V4_SM["session-manager<br/>Command x3, Hook x1"]
        V4_EXT["session-wrap (외부)<br/>Agent x5, Skill x3"]
    end

    V3_FEW -->|"분리"| V4_FEW
    V3_FEW -->|"분리"| V4_SM
    V4_SM -.->|"보완"| V4_EXT

    style V3_FEW fill:#06b6d4,color:#fff
    style V4_FEW fill:#06b6d4,color:#fff
    style V4_SM fill:#22c55e,color:#fff
    style V4_EXT fill:#f59e0b,color:#fff
```

| 항목 | v0.3 | v0.4 |
|------|------|------|
| 플러그인 수 | 1 (fe-workflow) | 2 (fe-workflow + session-manager) + 외부 1 |
| fe-workflow Commands | 6개 | 4개 (recap, organization 분리) |
| session-manager | 없음 | /save, /dashboard, /note + SessionStart Hook |
| 세션 분석 | /organization (단순) | /wrap (외부, 5-Agent 파이프라인) |
| 습관 측정 | 없음 | AI 협업 점수 /10 + habit-score 추적 |
| 학습 기록 | 없음 | /note (5 카테고리, .ai/notes/) |

## 파일 구조

```
ai-ax/
├── .claude-plugin/
│   └── marketplace.json           ← fe-workflow + session-manager 등록
├── .gyu/                          ← 사용자 소유 (설계/학습 문서)
├── .ai/                           ← Claude 소유 (세션 상태)
│   ├── STATUS.md
│   ├── DECISIONS.md
│   ├── notes/                     ← /note 산출물
│   └── logs/
│       ├── habit-score.md
│       └── sessions/
│
├── fe-workflow/                   ← FE 워크플로우 v0.4
│   ├── .claude-plugin/plugin.json
│   ├── skills/fe-principles/      ← Skill x1
│   ├── commands/                  ← Command x4
│   │   ├── architecture.md
│   │   ├── review.md
│   │   ├── pr.md
│   │   └── _pr.md (회사용)
│   ├── agents/                    ← Agent x2
│   │   ├── architect.md
│   │   └── code-reviewer.md
│   └── conventions/               ← Convention x4 (SSOT)
│       ├── code-principles.md
│       ├── folder-structure.md
│       ├── api-layer.md
│       └── error-handling.md
│
├── session-manager/               ← 세션 상태 관리 v0.1
│   ├── .claude-plugin/plugin.json
│   ├── commands/                  ← Command x3
│   │   ├── save.md
│   │   ├── dashboard.md
│   │   └── note.md
│   ├── hooks/hooks.json           ← Hook x1
│   └── scripts/session-start.mjs
│
└── mini-review/                   ← 학습용 (마켓플레이스 미등록)
```

## 범례

| 색상 | 컴포넌트 |
|------|----------|
| 보라 | Skill (자동 적용) |
| 파랑 | Command (사용자 호출) |
| 핑크 | Agent (위임 실행) |
| 노랑 | Convention (지식 소스) / 외부 플러그인 |
| 초록 | Hook / Script (이벤트 기반) |
| 회색 | 메타/문서/저장소 |
